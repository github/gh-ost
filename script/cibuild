#!/bin/bash

set -e

. script/common

echo "Verifying code is formatted via 'gofmt -s -w  go/'"
$DGO gofmt -s -w go
git diff --exit-code --quiet go

if [ "$1" != "fast" ]; then
  echo "Building"
  ./build.sh
fi

echo "Running unit tests"
$DGO go test ./go/...
